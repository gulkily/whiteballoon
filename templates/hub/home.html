<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WhiteBalloon Sync Hub</title>
    <style>
      :root {
        --primary-blue: #4169e1;
        --primary-purple: #9370db;
        --accent-purple: #a855f7;
        --success-green: #10b981;
        --bg-navy: rgba(30, 27, 75, 0.95);
        --text-primary: #ffffff;
        --text-secondary: #e5e7eb;
        --code-bg: rgba(0, 0, 0, 0.35);
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        min-height: 100vh;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        color: var(--text-primary);
        background: radial-gradient(circle at 20% 20%, rgba(65, 105, 225, 0.25), transparent 40%),
          radial-gradient(circle at 80% 0%, rgba(147, 112, 219, 0.25), transparent 35%),
          radial-gradient(circle at 50% 80%, rgba(168, 85, 247, 0.15), transparent 45%),
          #050318;
        overflow-x: hidden;
      }
      .orb {
        position: fixed;
        width: 240px;
        height: 240px;
        border-radius: 50%;
        filter: blur(40px);
        opacity: 0.35;
        animation: float 14s ease-in-out infinite alternate;
        background: radial-gradient(circle, rgba(147, 112, 219, 0.6), rgba(65, 105, 225, 0.1));
      }
      .orb--1 { top: 5%; left: 10%; }
      .orb--2 { bottom: 8%; right: 15%; animation-delay: 6s; width: 320px; height: 320px; }
      .layer { position: relative; padding: 4rem 2rem 5rem; display: flex; justify-content: center; }
      .panel {
        width: min(1100px, 100%);
        background: rgba(255, 255, 255, 0.08);
        border-radius: 32px;
        padding: clamp(2rem, 3vw, 3.5rem);
        backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 20px 60px rgba(15, 12, 41, 0.6), inset 0 0 40px rgba(255, 255, 255, 0.05);
        animation: fadeInUp 0.8s ease forwards;
      }
      header.hero {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        align-items: center;
        justify-content: space-between;
      }
      .tag {
        font-size: 0.85rem;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: var(--text-secondary);
        text-shadow: 0 0 12px rgba(255, 255, 255, 0.4);
      }
      h1 {
        font-size: clamp(2.2rem, 5vw, 3.3rem);
        margin: 0;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        background: linear-gradient(90deg, var(--primary-blue), var(--primary-purple));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .badge {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.25rem 0.75rem;
        border-radius: 999px;
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .badge--success { color: var(--success-green); box-shadow: 0 0 10px rgba(16, 185, 129, 0.4); }
      .badge--neutral { color: var(--text-secondary); }
      .live-indicator { display: inline-flex; align-items: center; gap: 0.3rem; font-size: 0.9rem; color: var(--text-secondary); }
      .live-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--success-green); animation: pulse 1.5s ease-in-out infinite; }
      .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem; margin: 2.5rem 0; }
      .stat-card {
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        padding: 1.25rem;
        display: flex;
        flex-direction: column;
        gap: 0.35rem;
      }
      .stat-label { font-size: 0.85rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-secondary); }
      .stat-value { font-size: 2rem; font-weight: 600; }
      .connection-strip { display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 2rem; }
      .connection-card { border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 999px; padding: 0.45rem 1rem; font-size: 0.9rem; color: var(--text-secondary); }
      table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
      th, td { padding: 0.85rem; text-align: left; border-bottom: 1px solid rgba(255, 255, 255, 0.08); }
      th { text-transform: uppercase; letter-spacing: 0.08em; font-size: 0.8rem; color: var(--text-secondary); }
      .peer-icon { display: inline-flex; align-items: center; gap: 0.5rem; }
      .relative-time { color: var(--text-secondary); }
      .code-block {
        background: var(--code-bg);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 16px;
        padding: 1rem 1.5rem;
        font-family: 'JetBrains Mono', SFMono-Regular, 'Cascadia Code', 'Courier New', monospace;
        margin-top: 2rem;
        overflow-x: auto;
      }
      @keyframes float {
        from { transform: translateY(0); }
        to { transform: translateY(-40px); }
      }
      @keyframes pulse {
        0% { opacity: 0.4; }
        50% { opacity: 1; }
        100% { opacity: 0.4; }
      }
    </style>
  </head>
  <body>
    <div class="orb orb--1"></div>
    <div class="orb orb--2"></div>
    <div class="layer">
      <section class="panel">
        <header class="hero">
          <div class="tag">WhiteBalloon · Sync Hub</div>
          <div class="live-indicator"><span class="live-dot"></span> live cluster status</div>
        </header>
        <h1>Sync Control Hub</h1>

        <div class="stats-grid">
          <article class="stat-card">
            <span class="stat-label">Tracked files</span>
            <span class="stat-value">{{ total_files }}</span>
          </article>
          <article class="stat-card">
            <span class="stat-label">Stored data (KB)</span>
            <span class="stat-value">{{ total_kilobytes }}</span>
          </article>
          <article class="stat-card">
            <span class="stat-label">Ready peers</span>
            <span class="stat-value">{{ ready_count }}</span>
          </article>
          <article class="stat-card">
            <span class="stat-label">Public key</span>
            <span class="stat-value" style="font-size: 1rem; word-break: break-all;">{{ truncated_key }}</span>
          </article>
        </div>

        <div class="connection-strip">
          {% if has_peers %}
            {% for peer in peer_stats %}
              <div class="connection-card">{{ peer.name }}</div>
            {% endfor %}
          {% else %}
            <p>No peers yet—register one via <code>./wb sync peers add</code>.</p>
          {% endif %}
        </div>

        <table>
          <thead>
            <tr>
              <th>Peer</th>
              <th>Status</th>
              <th>Files</th>
              <th>Size (KB)</th>
              <th>Signed</th>
              <th>Digest</th>
            </tr>
          </thead>
          <tbody>
            {% if peer_stats %}
              {% for peer in peer_stats %}
                <tr>
                  <td>
                    <span class="peer-icon">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3" />
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c0 .69.4 1.31 1.01 1.59.61.28 1.31.16 1.79-.29l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V15a2 2 0 0 1-2.83 1.83 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06c.45-.48.57-1.18.29-1.79A1.65 1.65 0 0 0 19.4 15z" />
                      </svg>
                      <span class="peer-name">{{ peer.name }}</span>
                    </span>
                  </td>
                  <td>
                    <span class="badge {{ 'badge--success' if peer.has_bundle else 'badge--neutral' }}">{{ 'Ready' if peer.has_bundle else 'Waiting' }}</span>
                  </td>
                  <td>{{ peer.file_count }}</td>
                  <td>{{ peer.total_bytes // 1024 }}</td>
                  <td><span class="relative-time">{{ peer.signed_at }}</span></td>
                  <td><span class="digest" title="{{ peer.digest }}">{{ peer.digest }}</span></td>
                </tr>
              {% endfor %}
            {% else %}
              <tr><td colspan="6">No bundles stored yet.</td></tr>
            {% endif %}
          </tbody>
        </table>

        <div class="code-block">
          <p>Share this hub's public key with trusted peers:</p>
          <code>{{ public_key }}</code>
        </div>
      </section>
    </div>
  </body>
</html>
