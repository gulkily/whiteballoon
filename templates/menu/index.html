{% extends "base.html" %}

{% block title %}Menu Â· WhiteBalloon{% endblock %}

{% block nav %}
  {% include "partials/account_nav.html" %}
{% endblock %}

{% block content %}
{% import "partials/caption.html" as captions %}
<section class="section stack" data-page="site-menu">
  <header class="stack">
    <p class="muted small-text">Quick access</p>
    <h1>All destinations</h1>
    {{ captions.render(menu_caption) }}
  </header>

  {% for section in menu_sections %}
    <div class="card stack menu-section">
      <header class="stack">
        <h2>{{ section.title }}</h2>
        <p class="muted">{{ section.description }}</p>
      </header>
      <div class="menu-grid">
        {% for link in section.links %}
          {% set is_disabled = link.disabled %}
          {% set classes = 'menu-card' ~ (' menu-card--disabled' if is_disabled else '') %}
          {% if is_disabled %}
            <article class="{{ classes }}" aria-disabled="true">
              <div class="menu-card__body">
                <h3>
                  {% if link.icon %}
                    <span class="menu-card__icon">{% include link.icon %}</span>
                  {% endif %}
                  {{ link.title }}
                </h3>
                <p class="muted">{{ link.description }}</p>
              </div>
              <div class="menu-card__meta">
                {% if link.requires_full %}
                  <span class="meta-chip meta-chip--ghost">Full session</span>
                {% endif %}
                {% if link.admin_only %}
                  <span class="meta-chip meta-chip--ghost">Admin</span>
                {% endif %}
              </div>
              {% if link.disabled_hint %}
                <p class="menu-card__hint muted small-text">{{ link.disabled_hint }}</p>
              {% endif %}
            </article>
          {% else %}
            <a class="{{ classes }}" href="{{ link.href }}">
              <div class="menu-card__body">
                <h3>
                  {% if link.icon %}
                    <span class="menu-card__icon">{% include link.icon %}</span>
                  {% endif %}
                  {{ link.title }}
                </h3>
                <p class="muted">{{ link.description }}</p>
              </div>
              <div class="menu-card__meta">
                {% if link.requires_full %}
                  <span class="meta-chip meta-chip--ghost">Full session</span>
                {% endif %}
                {% if link.admin_only %}
                  <span class="meta-chip meta-chip--ghost">Admin</span>
                {% endif %}
              </div>
            </a>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  {% endfor %}

  <div class="card stack menu-section">
    <header class="stack">
      <h2>Session</h2>
      <p class="muted">Sign out securely from this device.</p>
    </header>
    <div class="menu-grid">
      <form class="menu-card" action="/logout" method="post">
        <div class="menu-card__body">
          <h3>Sign out</h3>
          <p class="muted">End your current session and require authentication next time.</p>
        </div>
        <div class="menu-card__meta">
          <button type="submit" class="button button--ghost">Sign out</button>
        </div>
      </form>
    </div>
  </div>
</section>
{% endblock %}
