{% set session = session if session is defined else None %}
{% set session_role = session_role if session_role is defined else None %}
{% set avatar_url = session_avatar_url if session_avatar_url is defined else None %}
{% set show_admin = user.is_admin %}
{% set show_half_auth = session and (not session.is_fully_authenticated) %}
{% set primary_links = [
  {"label": "Requests", "href": "/"},
  {"label": "Comments", "href": "/browse?tab=comments"},
  {"label": "Browse", "href": "/browse"},
  {"label": "Menu", "href": "/menu"},
] %}
<div class="account-nav">
  <nav class="account-nav__primary" aria-label="Primary">
    {% for link in primary_links %}
      <a class="account-nav__link" href="{{ link.href }}">{{ link.label }}</a>
    {% endfor %}
  </nav>
  <div class="account-nav__utility">
    {% if session_role %}
      {% if show_admin %}
        <a class="account-status__tag account-status__tag--role account-status__tag--link" href="/admin" data-session-role>
          Admin
        </a>
      {% else %}
        <span class="account-status__tag account-status__tag--role" data-session-role>{{ session_role.label }}</span>
      {% endif %}
    {% endif %}
    {% if show_half_auth %}
      <span class="account-status__tag account-status__tag--half" title="Complete verification to unlock full access">Half-auth</span>
    {% endif %}
    <a class="account-nav__user" href="/profile">
      <span class="account-nav__avatar" aria-hidden="true">
        {% if avatar_url %}
          <img src="{{ avatar_url }}" alt="" />
        {% else %}
          <span class="account-nav__avatar-initials">{{ user.username[:2] | upper }}</span>
        {% endif %}
      </span>
      <span class="account-nav__name">@{{ user.username }}</span>
    </a>
  </div>
</div>
