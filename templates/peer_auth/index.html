{% extends "base.html" %}

{% block title %}Peer Authentication · WhiteBalloon{% endblock %}

{% block nav %}
  {% include "partials/account_nav.html" %}
{% endblock %}

{% block content %}
<section class="section stack" data-page="peer-auth">
  <header class="stack">
    <p class="muted small-text">Reviewer access</p>
    <h1>Peer authentication queue</h1>
    <p class="muted">Approve or deny half-authenticated sessions after confirming the 6-digit code with the requester via an out-of-band channel.</p>
  </header>

  <div class="card stack" data-section="peer-auth">
    <div class="peer-auth-meta">
      <p class="muted small-text">Awaiting review</p>
      <p class="peer-auth-meta__value">{{ peer_auth_pending_count }}</p>
    </div>

    {% if peer_auth_sessions %}
      <ol class="peer-auth-list" role="list">
        {% for record in peer_auth_sessions %}
          <li class="peer-auth-card">
            <header class="peer-auth-card__header">
              <div class="peer-auth-card__identity">
                <p class="peer-auth-card__username">@{{ record.username }}</p>
                <p class="muted small-text">Session {{ record.session_id[:8] }} · Requested {{ record.auth_request_created_at | friendly_time if record.auth_request_created_at else 'Unknown' }}</p>
              </div>
              <span class="meta-chip meta-chip--status meta-chip--pending">
                <span class="meta-chip__label">Status</span>
                <span class="meta-chip__value">{{ record.status.value | capitalize }}</span>
              </span>
            </header>
            <dl class="peer-auth-card__facts">
              <div>
                <dt>6-digit code</dt>
                <dd class="peer-auth-card__code">{{ record.verification_code }}</dd>
              </div>
              <div>
                <dt>Last seen</dt>
                <dd>{{ record.session_last_seen_at | friendly_time if record.session_last_seen_at else 'Unknown' }}</dd>
              </div>
              <div>
                <dt>IP / Device</dt>
                <dd>{{ record.ip_address or 'Unknown' }} · {{ record.device_info or 'Unknown' }}</dd>
              </div>
            </dl>
            <div class="peer-auth-card__actions">
              <button class="button button--secondary" type="button" disabled title="Coming soon">Review</button>
            </div>
          </li>
        {% endfor %}
      </ol>
    {% else %}
      <p class="muted">No pending peer-auth sessions at the moment.</p>
    {% endif %}
  </div>
</section>
{% endblock %}
