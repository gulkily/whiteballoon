{% extends "base.html" %}

{% block title %}{{ person.username }} · Comments · {{ site_title() }}{% endblock %}

{% block nav %}
  {% include "partials/account_nav.html" %}
{% endblock %}

{% block content %}
<section class="section stack">
  <header class="profile-header">
    <div class="profile-header__body">
      <h1>All comments · {{ person.username }}</h1>
      <p class="muted">Only administrators can review full comment history.</p>
    </div>
    <div class="profile-header__actions">
      <a class="button button--ghost" href="{{ profile_url }}">Back to profile</a>
    </div>
  </header>

  <article class="card stack">
    {% if comment_groups %}
      <div class="profile-comment-groups">
        {% for group in comment_groups %}
          <section class="profile-comment-group">
            <header class="profile-comment-group__header">
              <a href="{{ group.request_url }}" class="profile-comment-group__title">
                Request #{{ group.request_id }} · {{ group.request_title or 'Untitled request' }}
              </a>
            </header>
            <ul class="profile-recent-comments">
              {% for comment in group.comments %}
                {% with variant = 'profile' %}
                  {% include "partials/comment_card.html" %}
                {% endwith %}
              {% endfor %}
            </ul>
          </section>
        {% endfor %}
      </div>
      {% if pagination.total_pages > 1 %}
        <div class="profile-comments-pagination">
          <p class="muted small-text">Page {{ pagination.current_page }} of {{ pagination.total_pages }} · {{ pagination.total_comments }} total</p>
          <div class="profile-comments-pagination__actions">
            {% if pagination.has_prev %}
              <a class="button button--ghost" href="{{ pagination.prev_url }}">Previous</a>
            {% else %}
              <span class="button button--ghost button--disabled" aria-disabled="true">Previous</span>
            {% endif %}
            {% if pagination.has_next %}
              <a class="button button--ghost" href="{{ pagination.next_url }}">Next</a>
            {% else %}
              <span class="button button--ghost button--disabled" aria-disabled="true">Next</span>
            {% endif %}
          </div>
        </div>
      {% endif %}
    {% else %}
      <p class="muted">No comments yet.</p>
    {% endif %}
  </article>
</section>
{% endblock %}
