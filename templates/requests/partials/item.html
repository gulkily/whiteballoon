{% set readonly = readonly if readonly is defined else False %}
{% set can_complete = item.can_complete | default(false) %}
{% set creator_name = item.created_by_username | default('') %}
{% if not creator_name %}
  {% set creator_name = 'Community member' %}
{% endif %}
<article class="request-item">
  <header class="request-meta">
    <div class="request-meta__lead">
      <span class="request-creator" title="{{ creator_name }}">{{ creator_name }}</span>
      <span class="badge{% if item.status == 'completed' %} badge--completed{% endif %}">
        {{ item.status|title }}
      </span>
    </div>
    <time datetime="{{ item.created_at }}" class="muted">{{ item.created_at | replace('T', ' ') | replace('Z', '') }}</time>
  </header>
  <div>
    <p>{{ item.description or 'No additional details.' }}</p>
  </div>
  <footer class="actions">
    {% if not readonly and item.status != 'completed' and can_complete %}
      <form method='post' action='/requests/{{ item.id }}/complete' data-request-complete data-request-id='{{ item.id }}' class='inline'>
        <button type='submit' class='button'>Mark completed</button>
      </form>
    {% elif item.status == 'completed' %}
      <span class="muted">Completed {{ item.completed_at | default('recently') | replace('T', ' ') | replace('Z', '') }}</span>
    {% endif %}
    {% if item.contact_email %}
      <span class='muted'>Contact: {{ item.contact_email }}</span>
    {% endif %}
  </footer>
</article>
